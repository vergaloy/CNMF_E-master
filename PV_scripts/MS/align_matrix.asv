function out=align_matrix(X,Y)

n=size(X,2);
X=X-sum(X,1);
Y=Y-sum(Y,1);
[A,phi,C] = svd(X'*Y);


T=C*A';  %optimal rotation
s=trace(X'*Y*T)/trace(Y'*Y);  %optimal dilatation
M=s*Y*T;

t=mean(X-M,1)'; %optimal translation
out=M+t';

scatter(X(:,1),X(:,2))
hold on
scatter(M(:,1),M(:,2),'.')


scatter(X(:,1),X(:,2))
hold on
scatter(M(:,1),M(:,2),'.')